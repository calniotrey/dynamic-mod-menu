namespace = msm_events
#
#THIS = player/country pressing the button
country_event = {
	id = msm_events.0
	is_triggered_only = yes
	title = "msm.0.name"
	desc = "msm.0.desc"
	diplomatic = yes
	custom_gui = "msm_window"
	immediate = {
		msm_create_global_country_if_needed = yes
		set_variable = {
			which = msm_leader_index
			value = msm_starting_leader_index
		}
		event_target:msm_global_country = {
			every_owned_leader = {
				limit = {
					leader_class = general
				}
				root = {
					subtract_variable = {
						which = msm_leader_index
						value = 1
					}
					if = {
						limit = {
							check_variable = {
								which = msm_leader_index
								value < 0
							}
							check_variable = {
								which = msm_leader_index
								value > -17
							}
						}
						msm_store_leader_list = yes
					}
				}
			}
		}
	}
	option = {
		name = msm.0.prev
		custom_gui = "msm_previous_button"
		allow = {
			hidden_trigger = {
				check_variable = {
					which = msm_starting_leader_index
					value > 15
				}
			}
		}
		hidden_effect = {
			subtract_variable = {
				which = msm_starting_leader_index
				value = 16
			}
			msm_clear_variable_list = yes
			country_event = {
				id = msm_events.0
			}
		}
	}
	option = {
		name = msm.0.close
		custom_gui = "msm_close_button"
		default_hide_option = yes
		hidden_effect = {
			msm_close_msm_menu = yes
		}
	}
	option = {
		name = msm.0.next
		custom_gui = "msm_next_button"
		allow = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_index
					value < -16
				}
			}
		}
		hidden_effect = {
			change_variable = {
				which = msm_starting_leader_index
				value = 16
			}
			msm_clear_variable_list = yes
			country_event = {
				id = msm_events.0
			}
		}
	}
	option = {
		name = msm.0.0
		custom_gui = "msm_left_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_0
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 0
			}
		}
	}
	option = {
		name = msm.0.1
		custom_gui = "msm_right_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_1
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 1
			}
		}
	}
	option = {
		name = msm.0.2
		custom_gui = "msm_left_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_2
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 2
			}
		}
	}
	option = {
		name = msm.0.3
		custom_gui = "msm_right_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_3
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 3
			}
		}
	}
	option = {
		name = msm.0.4
		custom_gui = "msm_left_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_4
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 4
			}
		}
	}
	option = {
		name = msm.0.5
		custom_gui = "msm_right_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_5
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 5
			}
		}
	}
	option = {
		name = msm.0.6
		custom_gui = "msm_left_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_6
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 6
			}
		}
	}
	option = {
		name = msm.0.7
		custom_gui = "msm_right_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_7
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 7
			}
		}
	}
	option = {
		name = msm.0.8
		custom_gui = "msm_left_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_8
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 8
			}
		}
	}
	option = {
		name = msm.0.9
		custom_gui = "msm_right_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_9
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = 9
			}
		}
	}
	option = {
		name = msm.0.a
		custom_gui = "msm_left_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_a
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = a
			}
		}
	}
	option = {
		name = msm.0.b
		custom_gui = "msm_right_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_b
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = b
			}
		}
	}
	option = {
		name = msm.0.c
		custom_gui = "msm_left_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_c
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = c
			}
		}
	}
	option = {
		name = msm.0.d
		custom_gui = "msm_right_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_d
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = d
			}
		}
	}
	option = {
		name = msm.0.e
		custom_gui = "msm_left_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_e
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = e
			}
		}
	}
	option = {
		name = msm.0.f
		custom_gui = "msm_right_option"
		trigger = {
			hidden_trigger = {
				check_variable = {
					which = msm_leader_f
					value = 1
				}
			}
		}
		hidden_effect = {
			msm_call_mod_menu = {
				INDEX = f
			}
		}
	}
	option = {
		name = msm.0.close
		custom_gui = "msm_dummy_button"
		hidden_effect = {
			msm_close_msm_menu = yes
		}
	}
}

event = {
	id = msm_events.10
	is_triggered_only = yes
	hide_window = yes
	immediate = {
		set_global_flag = msm_installed
		msm_create_global_country_if_needed = yes
		event_target:msm_global_country = {
			country_event = {
				id = msm_events.11
				days = 1
			}
		}
	}
}

country_event = {
	id = msm_events.11
	is_triggered_only = yes
	hide_window = yes
	immediate = {
		# TODO register some big mods
	}
}
